{% extends '@EasyAdmin/page/content.html.twig' %}

{% block content %}

	<div class="container">
		<h2 class="mb-4">Statistiques des visites</h2>
		<div class="filters mb-4">
			<a href="{{ path('admin_stats', {filter: 'week'}) }}" class="btn btn-sm {{ currentFilter == 'week' ? 'btn-primary' : 'btn-outline-primary' }}">Semaine</a>
			<a href="{{ path('admin_stats', {filter: 'month'}) }}" class="btn btn-sm {{ currentFilter == 'month' ? 'btn-primary' : 'btn-outline-primary' }}">Mois</a>
			<a href="{{ path('admin_stats', {filter: 'year'}) }}" class="btn btn-sm {{ currentFilter == 'year' ? 'btn-primary' : 'btn-outline-primary' }}">Ann√©e</a>
		</div>


		<table class=" table table-striped">
			<thead>
				<tr>
					<th>Source</th>
					<th>Nombre de visites</th>
				</tr>
			</thead>
			<tbody>

				{% for stat in stats %}


					<tr>
						<td>{{ stat.source ?: 'Direct' }}</td>
						<td>{{ stat.visitCount }}</td>
					</tr>
				{% else %}
					<tr>
						<td colspan="2" class="text-center">Aucune donn√©e disponible</td>
					</tr>
				{% endfor %}
			</tbody>
		</table>
	</div>
	<canvas id="visitsChart" width="400" height="400"></canvas>

	<script>
		var visitsData = {
labels: {{ stats|map(s => s.source)|json_encode()|raw }},
datasets: [
{
label: 'Nombre de visites par source',
data: {{ stats|map(s => s.visitCount)|json_encode()|raw }},
backgroundColor: [
'rgba(255, 99, 132, 0.5)',
'rgba(54, 162, 235, 0.5)',
'rgba(255, 206, 86, 0.5)',
'rgba(75, 192, 192, 0.5)',
'rgba(153, 102, 255, 0.5)'
],
borderColor: [
'rgba(255, 99, 132, 1)',
'rgba(54, 162, 235, 1)',
'rgba(255, 206, 86, 1)',
'rgba(75, 192, 192, 1)',
'rgba(153, 102, 255, 1)'
],
borderWidth: 1
}
]
};

console.log("üìä Donn√©es envoy√©es √† Chart.js :", visitsData);
	</script>


{% endblock %}
{% block importmap %}{# do NOT call parent() #}{{ importmap(['app', 'graphique','chart.umd.js']) }}

{% endblock %}
